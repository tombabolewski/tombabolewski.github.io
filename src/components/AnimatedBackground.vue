<template>
  <div class="background-container">
    <div class="background-overlay"></div>
    <div class="background-elements">
      <div
        v-for="(shape, i) in shapes"
        class="background-blob"
        :key="'blob' + i"
      >
        <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
          <path :d="shape" :fill="getRandomColor()" />
        </svg>
      </div>
    </div>
  </div>
</template>

<script>
import anime from "animejs/lib/anime.es.js";
import arrayHelper from "../helpers/array";

export default {
  name: "AnimatedBackground",
  data: () => ({
    blobs: [],
    tl: null,
    tlColor: null,
    tlShape: null,
    palette: ["#0E21A0", "#4D2DB7", "#9D44C0", "#EC53B0"],
    shapes: [
      "M42.1,-67.8C52.5,-67,57.2,-51.4,57,-37.6C56.7,-23.9,51.4,-11.9,49.4,-1.2C47.4,9.6,48.7,19.3,42.5,21.7C36.2,24.2,22.4,19.5,14.1,20.5C5.7,21.4,2.9,27.9,-0.4,28.6C-3.7,29.3,-7.4,24.2,-21.8,26.8C-36.2,29.4,-61.4,39.7,-75,36.5C-88.6,33.3,-90.6,16.7,-76.4,8.2C-62.2,-0.3,-31.9,-0.6,-21,-8.4C-10,-16.2,-18.5,-31.5,-18.3,-38.1C-18,-44.7,-9,-42.6,3.4,-48.5C15.9,-54.5,31.8,-68.6,42.1,-67.8Z",
      "M9.8,-17.8C12.2,-15.6,13.2,-11.9,20.8,-8.7C28.3,-5.5,42.3,-2.7,45.7,2C49.1,6.7,41.9,13.3,37.6,22.1C33.3,31,31.9,42,26.1,45.7C20.4,49.4,10.2,45.8,-3,51C-16.2,56.2,-32.4,70.2,-37.1,65.9C-41.8,61.5,-35,38.9,-33.6,24.9C-32.1,10.9,-36,5.4,-40.3,-2.5C-44.6,-10.4,-49.3,-20.8,-48.5,-30.9C-47.7,-41,-41.4,-50.8,-32.4,-49.2C-23.3,-47.5,-11.7,-34.4,-4,-27.5C3.7,-20.6,7.4,-19.9,9.8,-17.8Z",
      "M17.7,-29.8C31.5,-22.7,57.1,-35.2,63.2,-33.5C69.3,-31.8,55.8,-15.9,56.4,0.3C57,16.6,71.5,33.1,64.8,33.7C58,34.3,30,18.8,15.6,19.7C1.3,20.5,0.6,37.8,-1.4,40.2C-3.5,42.7,-7,30.5,-9.4,22.7C-11.8,14.9,-13.1,11.6,-12.1,8.6C-11.2,5.5,-7.9,2.8,-8.2,-0.2C-8.5,-3.1,-12.4,-6.3,-11.9,-6.8C-11.5,-7.4,-6.7,-5.4,-4,-18.9C-1.3,-32.5,-0.6,-61.7,0.7,-62.8C1.9,-64,3.9,-37,17.7,-29.8Z",
      "M33,-62.4C38.7,-53.9,36.4,-36.8,36.1,-25C35.8,-13.1,37.4,-6.6,40.9,2C44.3,10.5,49.5,21.1,49.9,33C50.3,45,45.8,58.3,36.7,68.2C27.6,78,13.8,84.4,1.7,81.6C-10.5,78.7,-20.9,66.5,-33.7,58.7C-46.5,51,-61.5,47.6,-72.5,38.6C-83.5,29.5,-90.4,14.7,-77.7,7.3C-65.1,-0.1,-32.9,-0.3,-24,-13C-15.2,-25.7,-29.6,-51,-29.5,-62.8C-29.4,-74.5,-14.7,-72.8,-0.5,-71.9C13.7,-71,27.3,-71,33,-62.4Z",
      "M40.6,-64.5C52.3,-63.6,61.1,-52,54.3,-39.5C47.6,-26.9,25.3,-13.5,16.4,-5.1C7.5,3.2,12.1,6.4,14,10.6C15.9,14.8,15.2,19.9,12.4,20.6C9.7,21.2,4.8,17.2,-4.9,25.6C-14.5,34,-29.1,54.8,-39.6,58.6C-50.1,62.5,-56.5,49.4,-60.5,36.8C-64.4,24.2,-65.9,12.1,-67.9,-1.2C-69.9,-14.4,-72.4,-28.9,-69.2,-42.6C-65.9,-56.4,-56.8,-69.5,-44.3,-69.9C-31.8,-70.3,-15.9,-58.1,-0.7,-56.8C14.5,-55.6,29,-65.4,40.6,-64.5Z",
      "M18.4,-29.2C28.1,-26.3,43.1,-29.9,41.5,-26.1C40,-22.4,21.9,-11.2,24.7,1.6C27.5,14.5,51.3,28.9,55.6,37.5C59.9,46,44.8,48.7,32.3,50.1C19.8,51.5,9.9,51.7,3,46.4C-3.8,41.2,-7.6,30.5,-13.6,25.2C-19.5,20,-27.6,20.3,-26,17C-24.5,13.7,-13.2,6.9,-14.7,-0.8C-16.2,-8.6,-30.4,-17.1,-35.8,-27.1C-41.2,-37,-37.8,-48.3,-30.4,-52.6C-22.9,-56.8,-11.5,-54.1,-3.6,-47.9C4.4,-41.8,8.7,-32.2,18.4,-29.2Z",
      "M37.6,-66.1C44.4,-61.1,42.8,-42.4,45,-29.1C47.2,-15.8,53.3,-7.9,49.2,-2.3C45.1,3.2,30.9,6.5,26.4,15.7C21.9,25,27,40.3,24.2,43.4C21.4,46.5,10.7,37.3,3.9,30.5C-2.9,23.7,-5.7,19.3,-15.2,20.1C-24.8,20.9,-40.9,26.9,-41.6,24.4C-42.3,22,-27.5,11,-26.5,0.6C-25.4,-9.8,-38.1,-19.6,-43,-31.6C-47.8,-43.7,-44.8,-58,-36.3,-62.1C-27.9,-66.1,-13.9,-59.9,0.7,-61.1C15.4,-62.4,30.7,-71.1,37.6,-66.1Z",
      "M34.4,-54.2C40.7,-55.9,39.3,-38.9,35.9,-26.7C32.6,-14.6,27.3,-7.3,28,0.4C28.7,8.1,35.4,16.2,34.6,21.1C33.7,26,25.4,27.8,18.4,29C11.3,30.3,5.7,31,-0.1,31.3C-6,31.6,-11.9,31.3,-25.8,34C-39.7,36.7,-61.4,42.4,-67.1,37.2C-72.7,32,-62.2,16,-53.7,4.9C-45.2,-6.2,-38.6,-12.3,-33.3,-18C-27.9,-23.8,-23.9,-29,-18.5,-28C-13.2,-26.9,-6.6,-19.4,3.7,-25.9C14,-32.3,28,-52.6,34.4,-54.2Z",
      "M36.6,-60.6C47.9,-56.8,58,-48.1,55.4,-37.2C52.8,-26.2,37.6,-13.1,36.9,-0.4C36.3,12.4,50.4,24.8,50.2,30.9C50.1,37.1,35.7,37,24.9,43.8C14.2,50.6,7.1,64.4,-2.6,68.9C-12.3,73.5,-24.7,68.8,-27.1,57.2C-29.6,45.6,-22.2,27,-17.5,16.4C-12.8,5.7,-10.9,2.8,-16.8,-3.4C-22.7,-9.6,-36.3,-19.2,-41.8,-31.4C-47.3,-43.5,-44.6,-58.1,-36.3,-63.6C-28,-69.1,-14,-65.5,-0.7,-64.3C12.6,-63.1,25.2,-64.3,36.6,-60.6Z",
      "M28.8,-47C41.7,-42.4,59.6,-43.6,70.4,-36.7C81.1,-29.8,84.7,-14.9,82.6,-1.2C80.5,12.5,72.6,24.9,58.5,26C44.4,27,24,16.7,13.2,18.8C2.5,20.9,1.2,35.5,-4.1,42.6C-9.5,49.8,-19,49.6,-26.7,45.7C-34.4,41.8,-40.3,34.2,-43.1,26C-45.9,17.8,-45.6,8.9,-51.1,-3.2C-56.7,-15.3,-68,-30.5,-61.1,-31.6C-54.1,-32.7,-28.9,-19.5,-15.7,-23.9C-2.4,-28.3,-1.2,-50.2,3.4,-56.1C7.9,-61.9,15.9,-51.6,28.8,-47Z",
      "M30,-58.7C31.6,-51.1,20.5,-28.2,27.2,-15.9C34,-3.6,58.5,-1.8,67.9,5.4C77.3,12.7,71.6,25.3,64.7,37.5C57.9,49.6,50,61.3,39,63.6C28.1,66,14,59,2.5,54.6C-8.9,50.2,-17.9,48.3,-22,42C-26.1,35.7,-25.3,25,-36.3,17.2C-47.2,9.5,-69.7,4.7,-70.2,-0.2C-70.6,-5.2,-48.9,-10.5,-39.4,-20.6C-29.9,-30.8,-32.6,-46,-28,-51.9C-23.5,-57.8,-11.8,-54.4,1.2,-56.5C14.2,-58.7,28.4,-66.3,30,-58.7Z",
    ],
  }),
  mounted() {
    this.init();
  },
  methods: {
    init() {
      this.tl = anime.timeline({
        loop: true,
      });
      this.tlColor = anime.timeline({
        loop: true,
      });
      this.tlShape = anime.timeline({
        loop: true,
      });
      Math.floor(Math.random() * 100) * (Math.random() > 0.5 ? 1 : -1);
      this.tl.add({
        targets: ".background-blob svg path",
        scale: 1,
        easing: "easeInOutExpo",
        translateX: this.getRandomCoord,
        translateY: this.getRandomCoord,
        duration: 0,
        fill: this.getRandomColor,
      });
      for (let i = 0; i < 5; i++) {
        this.tl.add({
          easing: "linear",
          targets: ".background-blob svg path",
          translateX: this.getRandomCoord,
          translateY: this.getRandomCoord,
          duration: 50000,
        });
        this.tlColor.add({
          easing: "easeInOutSine",
          targets: ".background-blob svg path",
          duration: 10000,
          fill: (el) => this.getRandomColor(el.getAttribute("fill")),
        });
        this.tlShape.add({
          easing: "linear",
          targets: ".background-blob svg path",
          duration: 12000,
          d: (el) => this.getRandomShape(el.getAttribute("d")),
        });
      }
    },
    getRandomColor(prev = null) {
      let rand;
      do {
        rand = Math.floor(Math.random() * 100) % this.palette.length;
      } while (prev === this.palette[rand]);
      return this.palette[rand];
    },
    getRandomShape(prev = null) {
      let rand;
      do {
        rand = Math.floor(Math.random() * 100) % this.shapes.length;
      } while (prev === this.shapes[rand]);
      return this.shapes[rand];
    },
    getRandomCoord() {
      return (
        Math.floor(Math.random() * 100) * (Math.random() > 0.5 ? 1 : -1) + 100
      );
    },
  },
  computed: {},
};
</script>

<style lang="scss" scoped>
.background {
  &-container {
    display: block;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: -999;
    width: 100vw;
    height: 100vh;
    background: #0c1556;
  }

  &-elements {
    display: block;
    position: relative;
    width: 100%;
    height: 100%;
  }

  &-blob {
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    height: 100%;
    width: 100%;
  }
  &-overlay {
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    height: 100%;
    width: 100%;
    z-index: 1;
    backdrop-filter: blur(400px);
  }
}
</style>
